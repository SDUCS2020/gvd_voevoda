{% extends 'base.html' %}
{% load static %} 
{% block content %}
        <!--
          1)–î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–µ–≤
            url: http://127.0.0.1:8000/api/fights/
            type: GET
            params: voevoda_id={{ request.session.voevoda_id }}

            –û–¢–í–ï–¢ –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ JSON–æ–≤:
            data: [{
              "id": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   !–†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
              "name": —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,     !–†–ï–ù–î–ï–†–ò–ú –ò –ü–†–Ø–ß–ï–ú –ü–û–î –ù–ï–ï –ü–ï–†–ï–•–û–î –ù–ê "{% url 'fight' %}?fight_id=[ID –∏–∑ –ø–æ–ª—è –≤—ã—à–µ]"
              "type": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ  (1, "–ê—Ç–∞–∫–∞"),
                                              (2, "–ó–∞—â–∏—Ç–∞"),
              "date": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ timestampt (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å.
                  —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –±–µ—Ä–µ–∑ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (–µ—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω–µ—á–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ),
              "voevoda_id": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
              "attack_1_pers": {
                  "id": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "name": —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, !–†–ï–ù–î–ï–†–ò–ú –ò –ü–†–Ø–ß–ï–ú –ü–û–î –ù–ï–ï –ü–ï–†–ï–•–û–î –ù–ê "{% url 'player' %}?player_id=[ID –∏–∑ –ø–æ–ª—è –≤—ã—à–µ]"
                  "level": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "clan": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,     ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_knight": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_necro": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_mag": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_elf": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_barbar": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_black_elf": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_demon": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_dwarf": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_step_barb": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "umka_pharaon": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_hunt": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_work": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_card": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_thief": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_ranger": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_mers": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_tactic": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_gard": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_seekers": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_leader": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_blacksmith": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,    ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                  "gild_gunsmith": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ   ! –†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
              },
              "attack_2_pers": –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∫–∞–∫ –≤—ã—à–µ, ! –†–µ–Ω–¥–µ—Ä–∏–º –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ –≤—ã—à–µ
              "defence_1_pers": –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∫–∞–∫ –≤—ã—à–µ,  ! –†–µ–Ω–¥–µ—Ä–∏–º –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ –≤—ã—à–µ
              "defence_2_pers": –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∫–∞–∫ –≤—ã—à–µ,  ! –†–µ–Ω–¥–µ—Ä–∏–º –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ –≤—ã—à–µ
              "attack_1_pers_preset": {
                  fraction -    (0, "–†—ã—Ü–∞—Ä—å"),    !–†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
                                (1, "–ù–µ–∫—Ä–æ–º–∞–Ω—Ç"),
                                (2, "–ú–∞–≥"),
                                (3, "–≠–ª—å—Ñ"),
                                (4, "–í–∞—Ä–≤–∞—Ä"),
                                (5, "–¢–µ–º–Ω—ã–π —ç–ª—å—Ñ"),
                                (6, "–î–µ–º–æ–Ω"),
                                (7, "–ì–Ω–æ–º"),
                                (8, "–°—Ç–µ–ø–Ω–æ–π –≤–∞—Ä–≤–∞—Ä"),
                                (9, "–§–∞—Ä–∞–æ–Ω"),  –Ω—É–∂–Ω–æ –∏–∑ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫—É

                name - —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø–æ–ª–µ   !–†–ï–ù–î–ï–†–ò–ú –ò –ü–†–Ø–ß–ï–ú –ü–û–î –ù–ï–ï –ü–ï–†–ï–•–û–î –ù–ê " % url 'preset' %?preset_id=[ID –∏–∑ –ø–æ–ª—è –≤—ã—à–µ]"
                description - –±–æ–ª—å—à–æ–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø–æ–ª–µ    !–†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
              },
              "attack_2_pers_preset": –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç–∞ –∫–∞–∫ –≤—ã—à–µ,    !–†–ï–ù–î–ï–†–ò–ú –ö–ê–ö –í–´–®–ï
              "defence_1_pers_preset": –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç–∞ –∫–∞–∫ –≤—ã—à–µ,   !–†–ï–ù–î–ï–†–ò–ú –ö–ê–ö –í–´–®–ï
              "defence_2_pers_preset": –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç–∞ –∫–∞–∫ –≤—ã—à–µ,   !–†–ï–ù–î–ï–†–ò–ú –ö–ê–ö –í–´–®–ï
              "result": —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ  (1, "–ü–æ–±–µ–¥–∞ —Å—Ç–æ—Ä–æ–Ω—ã –∞—Ç–∞–∫–∏"),
                                                (2, "–ü–æ–±–µ–¥–∞ —Å—Ç–æ—Ä–æ–Ω—ã –∑–∞—â–∏—Ç—ã"),
                                                  !–†–ï–ù–î–ï–†–ò–ú –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –±–æ—è (–æ–± —ç—Ç–æ–º –Ω–∏–∂–µ)
                                                  –≤—ã—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–±–µ–¥–∞(–∑–µ–ª–µ–Ω—ã–º)/–ø–æ—Ä–∞–∂–µ–Ω–∏–µ(–∫—Ä–∞—Å–Ω—ã–º). –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç –∫—Ä–∞—Å–∏–≤—ã–µ –∑–Ω–∞—á–∫–∏
                                                  –ü–†–ò –∞—Ç–∞–∫–µ 1 - –ø–æ–±–µ–¥–∞, 2 - –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
                                                  –ü–†–ò –∑–∞—â–∏—Ç–µ 1 - –ø–æ—Ä–∞–∂–µ–Ω–∏–µ, 2 - –ø–æ–±–µ–¥–∞
              "description": —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ   !–†–ï–ù–î–ï–†–ò–¢–¨ –ù–ï –ù–£–ñ–ù–û
            }]
        2)–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –±–æ–µ–≤ –∏ –Ω–∞–¥–æ –∏—Ö —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ 2 –∫–æ–ª–æ–Ω–∫–∏
          1. –ê—Ç–∞–∫–∏ (—É –Ω–∏—Ö –ø–æ–ª–µ type == 1)
          2. –ó–∞—â–∏—Ç—ã (—É –Ω–∏—Ö –ø–æ–ª–µ type == 2)
        3)–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É - –î–û–ë–ê–í–ò–¢–¨ –ë–û–ô
          –ø–æ–¥ –Ω–µ–π —Å–ø—Ä—è—Ç–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ "{% url 'fight' %}"

        -->
        <div class="sh_MenuPanel" style="width: 10px;">
            <div class="mm_l"></div>
            <div class="mm_r"></div>
            <a href="{% url 'main' %}">
                <img src="{% static 'voevoda_app/images/arrow.png' %}" href="{% url 'main' %}" class="cursor_main_menu">
            </a>
            <div class="main_menu" hwm_label=""><a href="{% url 'main' %}">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</a></div>
            <div class="not_auth_text_on_buttons2">–ò—Å—Ç–æ—Ä–∏—è –±–æ–µ–≤</div>
        </div>
        <div class="event-container" style="align-items: center; width: 70%; margin: auto;">
            <div class="fight-columns">
                <div class="fight-section">
                    <h3>üó°Ô∏è –ê—Ç–∞–∫–∏:</h3>
                    <div id="attacks" class="fights-container"></div>
                </div>
        
                <div class="fight-section">
                    <h3>üõ°Ô∏è –ó–∞—â–∏—Ç—ã:</h3>
                    <div id="defences" class="fights-container"></div>
                </div>
            </div>
        
            <div class="button-container">
                <a href="{% url 'fight' %}" class="add-preset-button">–î–æ–±–∞–≤–∏—Ç—å –±–æ–π</a>
            </div>
        </div>
        
            <script>
                const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        
                function formatDate(timestamp) {
                    const date = new Date(timestamp * 1000); 
                    return date.toLocaleString('ru-RU', { timeZone });
                }

                fetch(`http://127.0.0.1:8000/api/fights/?voevoda_id={{ request.session.voevoda_id }}`)
                    .then(response => response.json())
                    .then(data => {
                        const attacksDiv = document.getElementById('attacks');
                        const defencesDiv = document.getElementById('defences');
                        console.log(data);
                        data.data.forEach(fight => {
                            const fightDiv = document.createElement('div');
                            fightDiv.classList.add('fights');
        
                            const fightLink = document.createElement('a');
                            fightLink.href = `{% url 'fight' %}?fight_id=` + fight.id;
                            fightLink.textContent = fight.name;
        
                            const fightDate = document.createElement('p');
                            fightDate.textContent = `–î–∞—Ç–∞: ${formatDate(fight.date)}`;
        
                            const attack1Link = document.createElement('a');
                            attack1Link.href = `{% url 'player' %}?player_id=` + fight.attack_1_pers.id;
                            attack1Link.textContent = fight.attack_1_pers.name;
        
                            const attack1Preset = document.createElement('a');
                            attack1Preset.href = `{% url 'present' %}?preset_id=` + fight.attack_1_pers_preset.id;
                            attack1Preset.textContent = fight.attack_1_pers_preset.name;

                            const attack2Link = document.createElement('a');
                            attack2Link.href = `{% url 'player' %}?player_id=` + fight.attack_2_pers.id;
                            attack2Link.textContent = fight.attack_2_pers.name;
        
                            const attack2Preset = document.createElement('a');
                            attack2Preset.href = `{% url 'present' %}?preset_id=` + fight.attack_2_pers_preset.id;
                            attack2Preset.textContent = fight.attack_2_pers_preset.name;
        
                            const defence1Link = document.createElement('a');
                            defence1Link.href = `{% url 'player' %}?player_id=` + fight.defence_1_pers.id;
                            defence1Link.textContent = fight.defence_1_pers.name;
        
                            const defence1Preset = document.createElement('a');
                            defence1Preset.href = `{% url 'present' %}?preset_id=` + fight.defence_1_pers_preset.id;
                            defence1Preset.textContent = fight.defence_1_pers_preset.name;

                            const defence2Link = document.createElement('a');
                            defence2Link.href = `{% url 'player' %}?player_id=` + fight.defence_2_pers.id;
                            defence2Link.textContent = fight.defence_2_pers.name;
        
                            const defence2Preset = document.createElement('a');
                            defence2Preset.href = `{% url 'present' %}?preset_id=` + fight.defence_2_pers_preset.id;
                            defence2Preset.textContent = fight.defence_2_pers_preset.name;
        
                            const result = document.createElement('span');
                            result.classList.add('result');
                            if (fight.result === 1 && fight.type === 1 || fight.result === 2 && fight.type === 2) {
                                result.textContent = '–ü–æ–±–µ–¥–∞ —Å—Ç–æ—Ä–æ–Ω—ã –∞—Ç–∞–∫–∏';
                            } else {
                                result.textContent = '–ü–æ–±–µ–¥–∞ —Å—Ç–æ—Ä–æ–Ω—ã –∑–∞—â–∏—Ç—ã';
                            }
  
                            fightDiv.appendChild(fightLink);
                            fightDiv.appendChild(fightDate);
                            fightDiv.appendChild(document.createTextNode('–ò–≥—Ä–æ–∫ 1 –∞—Ç–∞–∫–∏: '));
                            fightDiv.appendChild(attack1Link);
                            fightDiv.appendChild(document.createTextNode(' (' + attack1Preset.textContent + ')'));
                            fightDiv.appendChild(document.createElement('br'));
                            fightDiv.appendChild(document.createTextNode('–ò–≥—Ä–æ–∫ 2 –∞—Ç–∞–∫–∏: '));
                            fightDiv.appendChild(attack2Link);
                            fightDiv.appendChild(document.createTextNode(' (' + attack2Preset.textContent + ')'));
                            fightDiv.appendChild(document.createElement('br'));

                            fightDiv.appendChild(document.createTextNode('–ò–≥—Ä–æ–∫ 1 –∑–∞—â–∏—Ç—ã: '));
                            fightDiv.appendChild(defence1Link);
                            fightDiv.appendChild(document.createTextNode(' (' + defence1Preset.textContent + ')'));
                            fightDiv.appendChild(document.createElement('br'));
                            fightDiv.appendChild(document.createTextNode('–ò–≥—Ä–æ–∫ 2 –∑–∞—â–∏—Ç—ã: '));
                            fightDiv.appendChild(defence2Link);
                            fightDiv.appendChild(document.createTextNode(' (' + defence2Preset.textContent + ')'));
                            fightDiv.appendChild(document.createElement('br'));

                            fightDiv.appendChild(result);

                            if (fight.type === 1) {
                                attacksDiv.appendChild(fightDiv);
                            } else if (fight.type === 2) {
                                defencesDiv.appendChild(fightDiv);
                            }
                        });
                    })
                    .catch(error => console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error));
            </script>
{% endblock %}